{"version":"1.101.0","results":[{"check_id":"custom-expression-as-sql","path":"custom-expression-as-sql.py","start":{"line":7,"col":12,"offset":247},"end":{"line":7,"col":62,"offset":297},"extra":{"message":"Detected a Custom Expression ''query.get_compiler(connection=connection)'' calling ''as_sql(...).'' This could lead to SQL injection, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.djangoproject.com/en/3.0/ref/models/expressions/#django.db.models.Func.as_sql","https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"],"category":"security","technology":["django"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"custom-expression-as-sql","path":"custom-expression-as-sql.py","start":{"line":35,"col":16,"offset":1440},"end":{"line":35,"col":64,"offset":1488},"extra":{"message":"Detected a Custom Expression ''super(SqlAggregate, self)'' calling ''as_sql(...).'' This could lead to SQL injection, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.djangoproject.com/en/3.0/ref/models/expressions/#django.db.models.Func.as_sql","https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"],"category":"security","technology":["django"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"custom-expression-as-sql","path":"custom-expression-as-sql.py","start":{"line":61,"col":22,"offset":2338},"end":{"line":61,"col":71,"offset":2387},"extra":{"message":"Detected a Custom Expression ''self.condition.query.where'' calling ''as_sql(...).'' This could lead to SQL injection, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.","metadata":{"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://docs.djangoproject.com/en/3.0/ref/models/expressions/#django.db.models.Func.as_sql","https://semgrep.dev/blog/2020/preventing-sql-injection-a-django-authors-perspective/"],"category":"security","technology":["django"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["custom-expression-as-sql.py"]},"skipped_rules":[]}
