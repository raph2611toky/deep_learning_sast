- rules:
  - id: doctrine-orm-dangerous-query
    languages:
    - php
    message: '`$QUERY` Detected string concatenation with a non-literal variable in
      a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
      is user-controlled and not properly sanitized. In order to prevent SQL injection,
      use parameterized queries or prepared statements instead.'
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command
        (''SQL Injection'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A01:2017 - Injection
      - A03:2021 - Injection
      references:
      - https://www.doctrine-project.org/projects/doctrine-dbal/en/current/reference/query-builder.html#security-safely-preventing-sql-injection
      - https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
      subcategory:
      - vuln
      technology:
      - doctrine
    mode: taint
    pattern-sinks:
    - patterns:
      - focus-metavariable: $SINK
      - pattern-either:
        - pattern: $QUERY->add(...,$SINK,...)
        - pattern: $QUERY->select(...,$SINK,...)
        - pattern: $QUERY->addSelect(...,$SINK,...)
        - pattern: $QUERY->delete(...,$SINK,...)
        - pattern: $QUERY->update(...,$SINK,...)
        - pattern: $QUERY->insert(...,$SINK,...)
        - pattern: $QUERY->from(...,$SINK,...)
        - pattern: $QUERY->join(...,$SINK,...)
        - pattern: $QUERY->innerJoin(...,$SINK,...)
        - pattern: $QUERY->leftJoin(...,$SINK,...)
        - pattern: $QUERY->rightJoin(...,$SINK,...)
        - pattern: $QUERY->where(...,$SINK,...)
        - pattern: $QUERY->andWhere(...,$SINK,...)
        - pattern: $QUERY->orWhere(...,$SINK,...)
        - pattern: $QUERY->groupBy(...,$SINK,...)
        - pattern: $QUERY->addGroupBy(...,$SINK,...)
        - pattern: $QUERY->having(...,$SINK,...)
        - pattern: $QUERY->andHaving(...,$SINK,...)
        - pattern: $QUERY->orHaving(...,$SINK,...)
        - pattern: $QUERY->orderBy(...,$SINK,...)
        - pattern: $QUERY->addOrderBy(...,$SINK,...)
        - pattern: $QUERY->set($SINK,...)
        - pattern: $QUERY->setValue($SINK,...)
      - pattern-either:
        - pattern-inside: '$Q = $X->createQueryBuilder();

            ...

            '
        - pattern-inside: '$Q = new QueryBuilder(...);

            ...

            '
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: sprintf(...)
        - pattern: '"...".$SMTH

            '
    severity: WARNING
- rules:
  - id: doctrine-dbal-dangerous-query
    languages:
    - php
    message: Detected string concatenation with a non-literal variable in a Doctrine
      DBAL query method. This could lead to SQL injection if the variable is user-controlled
      and not properly sanitized. In order to prevent SQL injection, use parameterized
      queries or prepared statements instead.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command
        (''SQL Injection'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: HIGH
      likelihood: LOW
      owasp:
      - A01:2017 - Injection
      - A03:2021 - Injection
      references:
      - https://www.doctrine-project.org/projects/doctrine-dbal/en/current/reference/security.html
      - https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html
      subcategory:
      - audit
      technology:
      - doctrine
    patterns:
    - pattern-either:
      - pattern: $CONNECTION->prepare($QUERY,...)
      - pattern: $CONNECTION->createQuery($QUERY,...)
      - pattern: $CONNECTION->executeQuery($QUERY,...)
    - pattern-either:
      - pattern-inside: 'use Doctrine\DBAL\Connection;

          ...

          '
      - pattern-inside: '$CONNECTION = $SMTH->getConnection(...);

          ...

          '
    - pattern-not: $CONNECTION->prepare("...",...)
    - pattern-not: $CONNECTION->createQuery("...",...)
    - pattern-not: $CONNECTION->executeQuery("...",...)
    severity: WARNING
- rules:
  - id: curl-ssl-verifypeer-off
    languages:
    - php
    message: SSL verification is disabled but should not be (currently CURLOPT_SSL_VERIFYPEER=
      $IS_VERIFIED)
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-319: Cleartext Transmission of Sensitive Information'
      impact: LOW
      likelihood: LOW
      owasp:
      - A03:2017 - Sensitive Data Exposure
      - A02:2021 - Cryptographic Failures
      references:
      - https://www.saotn.org/dont-turn-off-curlopt_ssl_verifypeer-fix-php-configuration/
      subcategory:
      - vuln
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: '$ARG = $IS_VERIFIED;

          ...

          curl_setopt(..., CURLOPT_SSL_VERIFYPEER, $ARG);

          '
      - pattern: curl_setopt(..., CURLOPT_SSL_VERIFYPEER, $IS_VERIFIED)
    - metavariable-regex:
        metavariable: $IS_VERIFIED
        regex: 0|false|null
    severity: ERROR
- rules:
  - id: redirect-to-request-uri
    languages:
    - php
    message: Redirecting to the current request URL may redirect to another domain,
      if the current path starts with two slashes.  E.g. in https://www.example.com//attacker.com,
      the value of REQUEST_URI is //attacker.com, and redirecting to it will redirect
      to that domain.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-601: URL Redirection to Untrusted Site (''Open Redirect'')'
      impact: LOW
      likelihood: MEDIUM
      owasp:
      - A05:2017 - Broken Access Control
      - A01:2021 - Broken Access Control
      references:
      - https://www.php.net/manual/en/reserved.variables.server.php
      - https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html
      subcategory:
      - vuln
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: 'header(''$LOCATION'' . $_SERVER[''REQUEST_URI'']);

          '
      - pattern: 'header(''$LOCATION'' . $_SERVER[''REQUEST_URI''] . $MORE);

          '
    - metavariable-regex:
        metavariable: $LOCATION
        regex: ^(?i)location:\s*$
    severity: WARNING
- rules:
  - id: openssl-cbc-static-iv
    languages:
    - php
    message: Static IV used with AES in CBC mode. Static IVs enable chosen-plaintext
      attacks against encrypted data.
    metadata:
      category: security
      confidence: HIGH
      cwe:
      - 'CWE-329: Generation of Predictable IV with CBC Mode'
      impact: MEDIUM
      likelihood: HIGH
      owasp:
      - A02:2021 - Cryptographic Failures
      references:
      - https://csrc.nist.gov/publications/detail/sp/800-38a/final
      subcategory:
      - vuln
      technology:
      - php
      - openssl
    patterns:
    - pattern-either:
      - pattern: openssl_encrypt($D, $M, $K, $FLAGS, "...",...);
      - pattern: openssl_decrypt($D, $M, $K, $FLAGS, "...",...);
    - metavariable-comparison:
        comparison: re.match(".*-CBC",$M)
        metavariable: $M
    severity: ERROR
- rules:
  - id: unserialize-use
    languages:
    - php
    message: Calling `unserialize()` with user input in the pattern can lead to arbitrary
      code execution. Consider using JSON or structured data approaches (e.g. Google
      Protocol Buffers).
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-502: Deserialization of Untrusted Data'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: LOW
      likelihood: LOW
      owasp:
      - A08:2017 - Insecure Deserialization
      - A08:2021 - Software and Data Integrity Failures
      references:
      - https://www.php.net/manual/en/function.unserialize.php
      - https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization.html
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: unserialize(...)
    - pattern-not: unserialize("...",...)
    severity: WARNING
- rules:
  - id: phpinfo-use
    languages:
    - php
    message: The 'phpinfo' function may reveal sensitive information about your environment.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-200: Exposure of Sensitive Information to an Unauthorized Actor'
      cwe2021-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A01:2021 - Broken Access Control
      references:
      - https://www.php.net/manual/en/function.phpinfo
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/PhpinfosSniff.php
      subcategory:
      - vuln
      technology:
      - php
    pattern: phpinfo(...);
    severity: ERROR
- rules:
  - id: php-permissive-cors
    languages:
    - php
    message: Access-Control-Allow-Origin response header is set to "*". This will
      disable CORS Same Origin Policy restrictions.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-346: Origin Validation Error'
      impact: LOW
      likelihood: LOW
      owasp:
      - A07:2021 - Identification and Authentication Failures
      references:
      - https://developer.mozilla.org/ru/docs/Web/HTTP/Headers/Access-Control-Allow-Origin
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: header($VALUE,...)
    - pattern-either:
      - pattern: header("...",...)
      - pattern-inside: '$VALUE = "...";

          ...

          '
    - metavariable-regex:
        metavariable: $VALUE
        regex: (\'|\")\s*(Access-Control-Allow-Origin|access-control-allow-origin)\s*:\s*(\*)\s*(\'|\")
    severity: WARNING
- rules:
  - id: weak-crypto
    languages:
    - php
    message: Detected usage of weak crypto function. Consider using stronger alternatives.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-328: Use of Weak Hash'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A03:2017 - Sensitive Data Exposure
      - A02:2021 - Cryptographic Failures
      references:
      - https://www.php.net/manual/en/book.sodium.php
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/CryptoFunctionsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: crypt(...)
      - pattern: hash('md5', ...)
      - pattern: hash('sha1', ...)
      - pattern: md5_file(...)
      - pattern: md5(...)
      - pattern: sha1_file(...)
      - pattern: sha1(...)
      - pattern: str_rot13(...)
    severity: ERROR
- rules:
  - id: ldap-bind-without-password
    languages:
    - php
    message: Detected anonymous LDAP bind. This permits anonymous users to execute
      LDAP statements. Consider enforcing authentication for LDAP.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-287: Improper Authentication'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: LOW
      likelihood: LOW
      owasp:
      - A02:2017 - Broken Authentication
      - A07:2021 - Identification and Authentication Failures
      references:
      - https://www.php.net/manual/en/function.ldap-bind.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: ldap_bind($LDAP, $DN, NULL)
      - pattern: ldap_bind($LDAP, $DN, '')
      - patterns:
        - pattern: ldap_bind(...)
        - pattern-not: ldap_bind($LDAP, $DN, $PASSWORD)
    severity: WARNING
- rules:
  - id: assert-use
    languages:
    - php
    message: Calling assert with user input is equivalent to eval'ing.
    metadata:
      category: security
      confidence: HIGH
      cwe:
      - 'CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code
        (''Eval Injection'')'
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.assert
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/AssertsSniff.php
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sinks:
    - patterns:
      - pattern: assert($SINK, ...);
      - pattern-not: assert("...", ...);
      - pattern: $SINK
    pattern-sources:
    - pattern-either:
      - patterns:
        - pattern-either:
          - pattern: $_GET
          - pattern: $_POST
          - pattern: $_COOKIE
          - pattern: $_REQUEST
          - pattern: $_SERVER
      - patterns:
        - pattern: 'Route::$METHOD($ROUTENAME, function(..., $ARG, ...) { ... })

            '
        - focus-metavariable: $ARG
    severity: ERROR
- rules:
  - id: mcrypt-use
    languages:
    - php
    message: Mcrypt functionality has been deprecated and/or removed in recent PHP
      versions. Consider using Sodium or OpenSSL.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-676: Use of Potentially Dangerous Function'
      impact: MEDIUM
      likelihood: LOW
      references:
      - https://www.php.net/manual/en/intro.mcrypt.php
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/CryptoFunctionsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: $FUNC(...);
    - metavariable-regex:
        metavariable: $FUNC
        regex: (mcrypt_|mdecrypt_).+
    severity: ERROR
- rules:
  - id: unlink-use
    languages:
    - php
    message: Using user input when deleting files with `unlink()` is potentially dangerous.
      A malicious actor could use this to modify or access files they have no right
      to.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-22: Improper Limitation of a Pathname to a Restricted Directory (''Path
        Traversal'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A05:2017 - Broken Access Control
      - A01:2021 - Broken Access Control
      references:
      - https://www.php.net/manual/en/function.unlink
      - https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: unlink(...)
    - pattern-not: unlink("...",...)
    severity: WARNING
- rules:
  - id: extract-user-data
    languages:
    - php
    message: Do not call 'extract()' on user-controllable data. If you must, then
      you must also provide the EXTR_SKIP flag to prevent overwriting existing variables.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-502: Deserialization of Untrusted Data'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A08:2017 - Insecure Deserialization
      - A08:2021 - Software and Data Integrity Failures
      references:
      - https://www.php.net/manual/en/function.extract.php#refsect1-function.extract-notes
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - pattern: extract($VAR, EXTR_SKIP,...)
    pattern-sinks:
    - pattern: extract(...)
    pattern-sources:
    - pattern-either:
      - pattern: $_GET[...]
      - pattern: $_FILES[...]
      - pattern: $_POST[...]
    severity: ERROR
- rules:
  - id: eval-use
    languages:
    - php
    message: Evaluating non-constant commands. This can lead to command injection.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-78: Improper Neutralization of Special Elements used in an OS Command
        (''OS Command Injection'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: HIGH
      likelihood: LOW
      owasp:
      - A01:2017 - Injection
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.eval
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/NoEvalsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: eval(...);
    - pattern-not: eval('...');
    severity: ERROR
- rules:
  - id: backticks-use
    languages:
    - php
    message: Backticks use may lead to command injection vulnerabilities.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      cwe2022-top25: true
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/language.operators.execution.php
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/BackticksSniff.php
      subcategory:
      - audit
      technology:
      - php
    pattern: '`...`;'
    severity: ERROR
- rules:
  - id: mb-ereg-replace-eval
    languages:
    - php
    message: Calling mb_ereg_replace with user input in the options can lead to arbitrary
      code execution. The eval modifier (`e`) evaluates the replacement argument as
      code.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.mb-ereg-replace.php
      - https://www.php.net/manual/en/function.mb-regex-set-options.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: mb_ereg_replace($PATTERN, $REPL, $STR, $OPTIONS);
    - pattern-not: mb_ereg_replace($PATTERN, $REPL, $STR, "...");
    severity: ERROR
- rules:
  - id: ftp-use
    languages:
    - php
    message: FTP allows for unencrypted file transfers. Consider using an encrypted
      alternative.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-319: Cleartext Transmission of Sensitive Information'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A03:2017 - Sensitive Data Exposure
      - A02:2021 - Cryptographic Failures
      references:
      - https://www.php.net/manual/en/intro.ftp.php
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/FringeFunctionsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: $FUNC(...);
    - metavariable-regex:
        metavariable: $FUNC
        regex: ftp_.+
    severity: ERROR
- rules:
  - id: base-convert-loses-precision
    languages:
    - php
    message: The function base_convert uses 64-bit numbers internally, and does not
      correctly convert large numbers. It is not suitable for random tokens such as
      those used for session tokens or CSRF tokens.
    metadata:
      category: security
      confidence: HIGH
      cwe:
      - 'CWE-190: Integer Overflow or Wraparound'
      impact: LOW
      likelihood: LOW
      references:
      - https://www.php.net/base_convert
      - https://www.sjoerdlangkemper.nl/2017/03/15/dont-use-base-convert-on-random-tokens/
      subcategory:
      - audit
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - patterns:
      - pattern: substr(..., $LENGTH)
      - metavariable-comparison:
          comparison: $LENGTH <= 7
          metavariable: $LENGTH
    pattern-sinks:
    - pattern: base_convert(...)
    pattern-sources:
    - pattern: hash(...)
    - pattern: hash_hmac(...)
    - pattern: sha1(...)
    - pattern: md5(...)
    - patterns:
      - pattern: random_bytes($N)
      - metavariable-comparison:
          comparison: $N > 7
          metavariable: $N
    - patterns:
      - pattern: openssl_random_pseudo_bytes($N)
      - metavariable-comparison:
          comparison: $N > 7
          metavariable: $N
    - patterns:
      - pattern: $OBJ->get_random_bytes($N)
      - metavariable-comparison:
          comparison: $N > 7
          metavariable: $N
    severity: WARNING
- rules:
  - id: tainted-exec
    languages:
    - php
    message: Executing non-constant commands. This can lead to command injection.
      You should use `escapeshellarg()` when using command.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      cwe2022-top25: true
      impact: HIGH
      likelihood: HIGH
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.stackhawk.com/blog/php-command-injection/
      - https://brightsec.com/blog/code-injection-php/
      - https://www.acunetix.com/websitesecurity/php-security-2/
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - pattern: escapeshellarg(...)
    pattern-sinks:
    - pattern: exec(...)
    - pattern: system(...)
    - pattern: popen(...)
    - pattern: passthru(...)
    - pattern: shell_exec(...)
    - pattern: pcntl_exec(...)
    - pattern: proc_open(...)
    pattern-sources:
    - pattern: $_REQUEST
    - pattern: $_GET
    - pattern: $_POST
    - pattern: $_COOKIE
    severity: ERROR
- rules:
  - id: md5-loose-equality
    languages:
    - php
    message: Make sure comparisons involving md5 values are strict (use `===` not
      `==`) to avoid type juggling issues
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-697: Incorrect Comparison'
      impact: LOW
      likelihood: LOW
      references:
      - https://www.php.net/manual/en/types.comparisons.php
      - https://www.whitehatsec.com/blog/magic-hashes/
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: $X == $FUNC(...)
      - pattern: $FUNC(...) == $X
      - pattern: $FUNC(...) == $FUNC(...)
    - metavariable-regex:
        metavariable: $FUNC
        regex: md5|md5_file
    severity: ERROR
- rules:
  - id: exec-use
    languages:
    - php
    message: Executing non-constant commands. This can lead to command injection.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      cwe2022-top25: true
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/SystemExecFunctionsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: $FUNC(...);
    - pattern-not: $FUNC('...', ...);
    - metavariable-regex:
        metavariable: $FUNC
        regex: exec|passthru|proc_open|popen|shell_exec|system|pcntl_exec
    severity: ERROR
- rules:
  - id: php-ssrf
    languages:
    - php
    message: The web server receives a URL or similar request from an upstream component
      and retrieves the contents of this URL, but it does not sufficiently ensure
      that the request is being sent to the expected destination. Dangerous function
      $FUNCS with payload $DATA
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-918: Server-Side Request Forgery (SSRF)'
      cwe2022-top25: true
      impact: HIGH
      likelihood: LOW
      owasp:
      - A10:2021 - Server-Side Request Forgery (SSRF)
      references:
      - https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern-either:
      - pattern: '$VAR=$DATA;

          ...

          $FUNCS(...,$VAR, ...);

          '
      - pattern: $FUNCS(...,$DATA, ...);
    - metavariable-pattern:
        metavariable: $DATA
        patterns:
        - pattern-either:
          - pattern: $_GET
          - pattern: $_POST
          - pattern: $_COOKIE
          - pattern: $_REQUEST
    - metavariable-pattern:
        metavariable: $FUNCS
        patterns:
        - pattern-either:
          - pattern: curl_setopt
          - pattern: fopen
          - pattern: file_get_contents
          - pattern: curl_init
          - pattern: readfile
    severity: ERROR
- rules:
  - id: file-inclusion
    languages:
    - php
    message: Detected non-constant file inclusion. This can lead to local file inclusion
      (LFI) or remote file inclusion (RFI) if user input reaches this statement. LFI
      and RFI could lead to sensitive files being obtained by attackers. Instead,
      explicitly specify what to include. If that is not a viable solution, validate
      user input thoroughly.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-98: Improper Control of Filename for Include/Require Statement in PHP
        Program (''PHP Remote File Inclusion'')'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.include.php
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/EasyRFISniff.php
      - https://en.wikipedia.org/wiki/File_inclusion_vulnerability#Types_of_Inclusion
      subcategory:
      - audit
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - patterns:
      - pattern-either:
        - pattern-inside: basename($PATH, ...)
        - pattern-inside: linkinfo($PATH, ...)
        - pattern-inside: readlink($PATH, ...)
        - pattern-inside: realpath($PATH, ...)
        - pattern-inside: include_safe(...)
    pattern-sinks:
    - patterns:
      - pattern-inside: $FUNC(...);
      - pattern: $VAR
      - metavariable-regex:
          metavariable: $FUNC
          regex: \b(include|include_once|require|require_once)\b
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
        - pattern: $_SERVER
    severity: ERROR
- rules:
  - id: md5-used-as-password
    languages:
    - php
    message: It looks like MD5 is used as a password hash. MD5 is not considered a
      secure password hash because it can be cracked by an attacker in a short amount
      of time. Use a suitable password hashing function such as bcrypt. You can use
      `password_hash($PASSWORD, PASSWORD_BCRYPT, $OPTIONS);`.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-327: Use of a Broken or Risky Cryptographic Algorithm'
      impact: MEDIUM
      likelihood: HIGH
      owasp:
      - A03:2017 - Sensitive Data Exposure
      - A02:2021 - Cryptographic Failures
      references:
      - https://tools.ietf.org/html/rfc6151
      - https://crypto.stackexchange.com/questions/44151/how-does-the-flame-malware-take-advantage-of-md5-collision
      - https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords
      - https://github.com/returntocorp/semgrep-rules/issues/1609
      - https://www.php.net/password_hash
      subcategory:
      - vuln
      technology:
      - md5
    mode: taint
    pattern-sinks:
    - patterns:
      - pattern: $FUNCTION(...)
      - metavariable-regex:
          metavariable: $FUNCTION
          regex: (?i)(.*password.*)
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: md5(...)
        - pattern: hash('md5', ...)
    severity: WARNING
- rules:
  - id: tainted-filename
    languages:
    - php
    message: File name based on user input risks server-side request forgery.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-918: Server-Side Request Forgery (SSRF)'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A10:2021 - Server-Side Request Forgery (SSRF)
      references:
      - https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - patterns:
      - pattern-either:
        - pattern-inside: basename($PATH, ...)
        - pattern-inside: linkinfo($PATH, ...)
        - pattern-inside: readlink($PATH, ...)
        - pattern-inside: realpath($PATH, ...)
    pattern-sinks:
    - patterns:
      - pattern-either:
        - pattern-inside: opcache_compile_file($FILENAME, ...)
        - pattern-inside: opcache_invalidate($FILENAME, ...)
        - pattern-inside: opcache_is_script_cached($FILENAME, ...)
        - pattern-inside: runkit7_import($FILENAME, ...)
        - pattern-inside: readline_read_history($FILENAME, ...)
        - pattern-inside: readline_write_history($FILENAME, ...)
        - pattern-inside: rar_open($FILENAME, ...)
        - pattern-inside: zip_open($FILENAME, ...)
        - pattern-inside: gzfile($FILENAME, ...)
        - pattern-inside: gzopen($FILENAME, ...)
        - pattern-inside: readgzfile($FILENAME, ...)
        - pattern-inside: hash_file($ALGO, $FILENAME, ...)
        - pattern-inside: hash_update_file($CONTEXT, $FILENAME, ...)
        - pattern-inside: pg_trace($FILENAME, ...)
        - pattern-inside: dio_open($FILENAME, ...)
        - pattern-inside: finfo_file($FINFO, $FILENAME, ...)
        - pattern-inside: mime_content_type($FILENAME, ...)
        - pattern-inside: chgrp($FILENAME, ...)
        - pattern-inside: chmod($FILENAME, ...)
        - pattern-inside: chown($FILENAME, ...)
        - pattern-inside: clearstatcache($CLEAR_REALPATH_CACHE, $FILENAME, ...)
        - pattern-inside: file_exists($FILENAME, ...)
        - pattern-inside: file_get_contents($FILENAME, ...)
        - pattern-inside: file_put_contents($FILENAME, ...)
        - pattern-inside: file($FILENAME, ...)
        - pattern-inside: fileatime($FILENAME, ...)
        - pattern-inside: filectime($FILENAME, ...)
        - pattern-inside: filegroup($FILENAME, ...)
        - pattern-inside: fileinode($FILENAME, ...)
        - pattern-inside: filemtime($FILENAME, ...)
        - pattern-inside: fileowner($FILENAME, ...)
        - pattern-inside: fileperms($FILENAME, ...)
        - pattern-inside: filesize($FILENAME, ...)
        - pattern-inside: filetype($FILENAME, ...)
        - pattern-inside: fnmatch($PATTERN, $FILENAME, ...)
        - pattern-inside: fopen($FILENAME, ...)
        - pattern-inside: is_dir($FILENAME, ...)
        - pattern-inside: is_executable($FILENAME, ...)
        - pattern-inside: is_file($FILENAME, ...)
        - pattern-inside: is_link($FILENAME, ...)
        - pattern-inside: is_readable($FILENAME, ...)
        - pattern-inside: is_uploaded_file($FILENAME, ...)
        - pattern-inside: is_writable($FILENAME, ...)
        - pattern-inside: lchgrp($FILENAME, ...)
        - pattern-inside: lchown($FILENAME, ...)
        - pattern-inside: lstat($FILENAME, ...)
        - pattern-inside: parse_ini_file($FILENAME, ...)
        - pattern-inside: readfile($FILENAME, ...)
        - pattern-inside: stat($FILENAME, ...)
        - pattern-inside: touch($FILENAME, ...)
        - pattern-inside: unlink($FILENAME, ...)
        - pattern-inside: xattr_get($FILENAME, ...)
        - pattern-inside: xattr_list($FILENAME, ...)
        - pattern-inside: xattr_remove($FILENAME, ...)
        - pattern-inside: xattr_set($FILENAME, ...)
        - pattern-inside: xattr_supported($FILENAME, ...)
        - pattern-inside: enchant_broker_request_pwl_dict($BROKER, $FILENAME, ...)
        - pattern-inside: pspell_config_personal($CONFIG, $FILENAME, ...)
        - pattern-inside: pspell_config_repl($CONFIG, $FILENAME, ...)
        - pattern-inside: pspell_new_personal($FILENAME, ...)
        - pattern-inside: exif_imagetype($FILENAME, ...)
        - pattern-inside: getimagesize($FILENAME, ...)
        - pattern-inside: image2wbmp($IMAGE, $FILENAME, ...)
        - pattern-inside: imagecreatefromavif($FILENAME, ...)
        - pattern-inside: imagecreatefrombmp($FILENAME, ...)
        - pattern-inside: imagecreatefromgd2($FILENAME, ...)
        - pattern-inside: imagecreatefromgd2part($FILENAME, ...)
        - pattern-inside: imagecreatefromgd($FILENAME, ...)
        - pattern-inside: imagecreatefromgif($FILENAME, ...)
        - pattern-inside: imagecreatefromjpeg($FILENAME, ...)
        - pattern-inside: imagecreatefrompng($FILENAME, ...)
        - pattern-inside: imagecreatefromtga($FILENAME, ...)
        - pattern-inside: imagecreatefromwbmp($FILENAME, ...)
        - pattern-inside: imagecreatefromwebp($FILENAME, ...)
        - pattern-inside: imagecreatefromxbm($FILENAME, ...)
        - pattern-inside: imagecreatefromxpm($FILENAME, ...)
        - pattern-inside: imageloadfont($FILENAME, ...)
        - pattern-inside: imagexbm($IMAGE, $FILENAME, ...)
        - pattern-inside: iptcembed($IPTC_DATA, $FILENAME, ...)
        - pattern-inside: mailparse_msg_extract_part_file($MIMEMAIL, $FILENAME, ...)
        - pattern-inside: mailparse_msg_extract_whole_part_file($MIMEMAIL, $FILENAME,
            ...)
        - pattern-inside: mailparse_msg_parse_file($FILENAME, ...)
        - pattern-inside: fdf_add_template($FDF_DOCUMENT, $NEWPAGE, $FILENAME, ...)
        - pattern-inside: fdf_get_ap($FDF_DOCUMENT, $FIELD, $FACE, $FILENAME, ...)
        - pattern-inside: fdf_open($FILENAME, ...)
        - pattern-inside: fdf_save($FDF_DOCUMENT, $FILENAME, ...)
        - pattern-inside: fdf_set_ap($FDF_DOCUMENT, $FIELD_NAME, $FACE, $FILENAME,
            ...)
        - pattern-inside: ps_add_launchlink($PSDOC, $LLX, $LLY, $URX, $URY, $FILENAME,
            ...)
        - pattern-inside: ps_add_pdflink($PSDOC, $LLX, $LLY, $URX, $URY, $FILENAME,
            ...)
        - pattern-inside: ps_open_file($PSDOC, $FILENAME, ...)
        - pattern-inside: ps_open_image_file($PSDOC, $TYPE, $FILENAME, ...)
        - pattern-inside: posix_access($FILENAME, ...)
        - pattern-inside: posix_mkfifo($FILENAME, ...)
        - pattern-inside: posix_mknod($FILENAME, ...)
        - pattern-inside: ftok($FILENAME, ...)
        - pattern-inside: fann_cascadetrain_on_file($ANN, $FILENAME, ...)
        - pattern-inside: fann_read_train_from_file($FILENAME, ...)
        - pattern-inside: fann_train_on_file($ANN, $FILENAME, ...)
        - pattern-inside: highlight_file($FILENAME, ...)
        - pattern-inside: php_strip_whitespace($FILENAME, ...)
        - pattern-inside: stream_resolve_include_path($FILENAME, ...)
        - pattern-inside: swoole_async_read($FILENAME, ...)
        - pattern-inside: swoole_async_readfile($FILENAME, ...)
        - pattern-inside: swoole_async_write($FILENAME, ...)
        - pattern-inside: swoole_async_writefile($FILENAME, ...)
        - pattern-inside: swoole_load_module($FILENAME, ...)
        - pattern-inside: tidy_parse_file($FILENAME, ...)
        - pattern-inside: tidy_repair_file($FILENAME, ...)
        - pattern-inside: get_meta_tags($FILENAME, ...)
        - pattern-inside: yaml_emit_file($FILENAME, ...)
        - pattern-inside: yaml_parse_file($FILENAME, ...)
        - pattern-inside: curl_file_create($FILENAME, ...)
        - pattern-inside: ftp_chmod($FTP, $PERMISSIONS, $FILENAME, ...)
        - pattern-inside: ftp_delete($FTP, $FILENAME, ...)
        - pattern-inside: ftp_mdtm($FTP, $FILENAME, ...)
        - pattern-inside: ftp_size($FTP, $FILENAME, ...)
        - pattern-inside: rrd_create($FILENAME, ...)
        - pattern-inside: rrd_fetch($FILENAME, ...)
        - pattern-inside: rrd_graph($FILENAME, ...)
        - pattern-inside: rrd_info($FILENAME, ...)
        - pattern-inside: rrd_last($FILENAME, ...)
        - pattern-inside: rrd_lastupdate($FILENAME, ...)
        - pattern-inside: rrd_tune($FILENAME, ...)
        - pattern-inside: rrd_update($FILENAME, ...)
        - pattern-inside: snmp_read_mib($FILENAME, ...)
        - pattern-inside: ssh2_sftp_chmod($SFTP, $FILENAME, ...)
        - pattern-inside: ssh2_sftp_realpath($SFTP, $FILENAME, ...)
        - pattern-inside: ssh2_sftp_unlink($SFTP, $FILENAME, ...)
        - pattern-inside: apache_lookup_uri($FILENAME, ...)
        - pattern-inside: md5_file($FILENAME, ...)
        - pattern-inside: sha1_file($FILENAME, ...)
        - pattern-inside: simplexml_load_file($FILENAME, ...)
      - pattern: $FILENAME
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
        - pattern: $_SERVER
    severity: WARNING
- rules:
  - id: tainted-url-host
    languages:
    - php
    message: User data flows into the host portion of this manually-constructed URL.
      This could allow an attacker to send data to their own server, potentially exposing
      sensitive data such as cookies or authorization information sent with this request.
      They could also probe internal servers or other resources that the server running
      this code can access. (This is called server-side request forgery, or SSRF.)
      Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts,
      or hardcode the correct host.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-918: Server-Side Request Forgery (SSRF)'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A10:2021 - Server-Side Request Forgery (SSRF)
      references:
      - https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sinks:
    - pattern-either:
      - patterns:
        - pattern: 'sprintf($URLSTR, ...)

            '
        - metavariable-pattern:
            language: generic
            metavariable: $URLSTR
            pattern: $SCHEME://%s
      - patterns:
        - pattern: '"...{$EXPR}..."

            '
        - pattern-regex: '.*://\{.*

            '
      - patterns:
        - pattern: '"...$EXPR..."

            '
        - pattern-regex: '.*://\$.*

            '
      - patterns:
        - pattern: '"...".$EXPR

            '
        - pattern-regex: '.*://["''].*

            '
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
    severity: WARNING
- rules:
  - id: tainted-session
    languages:
    - php
    message: Session key based on user input risks session poisoning. The user can
      determine the key used for the session, and thus write any session variable.
      Session variables are typically trusted to be set only by the application, and
      manipulating the session can result in access control issues.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-284: Improper Access Control'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A01:2021 - Broken Access Control
      references:
      - https://en.wikipedia.org/wiki/Session_poisoning
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - patterns:
      - pattern-either:
        - pattern: $A . $B
        - pattern: bin2hex(...)
        - pattern: crc32(...)
        - pattern: crypt(...)
        - pattern: filter_input(...)
        - pattern: filter_var(...)
        - pattern: hash(...)
        - pattern: md5(...)
        - pattern: preg_filter(...)
        - pattern: preg_grep(...)
        - pattern: preg_match_all(...)
        - pattern: sha1(...)
        - pattern: sprintf(...)
        - pattern: str_contains(...)
        - pattern: str_ends_with(...)
        - pattern: str_starts_with(...)
        - pattern: strcasecmp(...)
        - pattern: strchr(...)
        - pattern: stripos(...)
        - pattern: stristr(...)
        - pattern: strnatcasecmp(...)
        - pattern: strnatcmp(...)
        - pattern: strncmp(...)
        - pattern: strpbrk(...)
        - pattern: strpos(...)
        - pattern: strripos(...)
        - pattern: strrpos(...)
        - pattern: strspn(...)
        - pattern: strstr(...)
        - pattern: strtok(...)
        - pattern: substr_compare(...)
        - pattern: substr_count(...)
        - pattern: vsprintf(...)
    pattern-sinks:
    - patterns:
      - pattern-inside: $_SESSION[$KEY] = $VAL;
      - pattern: $KEY
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
    severity: WARNING
- rules:
  - id: tainted-sql-string
    languages:
    - php
    message: User data flows into this manually-constructed SQL string. User data
      can be safely inserted into SQL strings using prepared statements or an object-relational
      mapper (ORM). Manually-constructed SQL strings is a possible indicator of SQL
      injection, which could let an attacker steal or manipulate data from the database.
      Instead, use prepared statements (`$mysqli->prepare("INSERT INTO test(id, label)
      VALUES (?, ?)");`) or a safe library.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command
        (''SQL Injection'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: HIGH
      owasp:
      - A01:2017 - Injection
      - A03:2021 - Injection
      references:
      - https://owasp.org/www-community/attacks/SQL_Injection
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - pattern-either:
      - pattern: mysqli_real_escape_string(...)
      - pattern: real_escape_string(...)
      - pattern: $MYSQLI->real_escape_string(...)
    pattern-sinks:
    - pattern-either:
      - patterns:
        - pattern: 'sprintf($SQLSTR, ...)

            '
        - metavariable-regex:
            metavariable: $SQLSTR
            regex: .*\b(?i)(select|delete|insert|create|update|alter|drop)\b.*
      - patterns:
        - pattern: '"...$EXPR..."

            '
        - metavariable-regex:
            metavariable: $EXPR
            regex: .*\b(?i)(select|delete|insert|create|update|alter|drop)\b.*
      - patterns:
        - pattern: '"$SQLSTR".$EXPR

            '
        - metavariable-regex:
            metavariable: $SQLSTR
            regex: .*\b(?i)(select|delete|insert|create|update|alter|drop)\b.*
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
    severity: ERROR
- rules:
  - id: tainted-callable
    languages:
    - php
    message: Callable based on user input risks remote code execution.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      impact: HIGH
      likelihood: MEDIUM
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/language.types.callable.php
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sinks:
    - patterns:
      - pattern: $CALLABLE
      - pattern-either:
        - pattern-inside: $ARRAYITERATOR->uasort($CALLABLE)
        - pattern-inside: $ARRAYITERATOR->uksort($CALLABLE)
        - pattern-inside: $EVENTHTTP->setCallback($CALLABLE, ...)
        - pattern-inside: $EVENTHTTPCONNECTION->setCloseCallback($CALLABLE, ...)
        - pattern-inside: $EVLOOP->fork($CALLABLE, ...)
        - pattern-inside: $EVLOOP->idle($CALLABLE, ...)
        - pattern-inside: $EVLOOP->prepare($CALLABLE, ...)
        - pattern-inside: $EVWATCHER->setCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setClientCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setCompleteCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setCreatedCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setDataCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setExceptionCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setFailCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setStatusCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setWarningCallback($CALLABLE)
        - pattern-inside: $GEARMANCLIENT->setWorkloadCallback($CALLABLE)
        - pattern-inside: $IMAGICK->setProgressMonitor($CALLABLE)
        - pattern-inside: $OAUTHPROVIDER->consumerHandler($CALLABLE)
        - pattern-inside: $OAUTHPROVIDER->tokenHandler($CALLABLE)
        - pattern-inside: $PDO->sqliteCreateCollation($NAME, $CALLABLE)
        - pattern-inside: $PDOSTATEMENT->fetchAll(PDO::FETCH_FUNC, $CALLABLE)
        - pattern-inside: $SQLITE3->createCollation($NAME, $CALLABLE)
        - pattern-inside: $SQLITE3->setAuthorizer($CALLABLE)
        - pattern-inside: $ZIPARCHIVE->registerCancelCallback($CALLABLE)
        - pattern-inside: $ZIPARCHIVE->registerProgressCallback($RATE, $CALLABLE)
        - pattern-inside: $ZMQDEVICE->setIdleCallback($CALLABLE, ...)
        - pattern-inside: $ZMQDEVICE->setTimerCallback($CALLABLE, ...)
        - pattern-inside: apcu_entry($KEY, $CALLABLE, ...)
        - pattern-inside: array_filter($ARRAY, $CALLABLE, ...)
        - pattern-inside: array_map($CALLABLE, ...)
        - pattern-inside: array_reduce($ARRAY, $CALLABLE, ...)
        - pattern-inside: array_walk_recursive($ARRAY, $CALLABLE, ...)
        - pattern-inside: array_walk($ARRAY, $CALLABLE, ...)
        - pattern-inside: call_user_func_array($CALLABLE, ...)
        - pattern-inside: call_user_func($CALLABLE, ...)
        - pattern-inside: Closure::fromCallable($CALLABLE)
        - pattern-inside: createCollation($NAME, $CALLABLE)
        - pattern-inside: eio_grp($CALLABLE, ...)
        - pattern-inside: eio_nop($PRI, $CALLABLE, ...)
        - pattern-inside: eio_sync($PRI, $CALLABLE, ...)
        - pattern-inside: EvPrepare::createStopped($CALLABLE, ...)
        - pattern-inside: fann_set_callback($ANN, $CALLABLE)
        - pattern-inside: fdf_enum_values($FDF_DOCUMENT, $CALLABLE, ...)
        - pattern-inside: forward_static_call_array($CALLABLE, ...)
        - pattern-inside: forward_static_call($CALLABLE, ...)
        - pattern-inside: header_register_callback($CALLABLE)
        - pattern-inside: ibase_set_event_handler($CALLABLE, ...)
        - pattern-inside: IntlChar::enumCharTypes($CALLABLE)
        - pattern-inside: iterator_apply($ITERATOR, $CALLABLE)
        - pattern-inside: ldap_set_rebind_proc($LDAP, $CALLABLE)
        - pattern-inside: libxml_set_external_entity_loader($CALLABLE, ...)
        - pattern-inside: new CallbackFilterIterator($ITERATOR, $CALLABLE)
        - pattern-inside: new EvCheck($CALLABLE, ...)
        - pattern-inside: new EventHttpRequest($CALLABLE, ...)
        - pattern-inside: new EvFork($CALLABLE, ...)
        - pattern-inside: new EvIdle($CALLABLE, ...)
        - pattern-inside: new Fiber($CALLABLE)
        - pattern-inside: new Memcached($PERSISTENT_ID, $CALLABLE, ...)
        - pattern-inside: new RecursiveCallbackFilterIterator($ITERATOR, $CALLABLE)
        - pattern-inside: new Zookeeper($HOST, $CALLABLE, ...)
        - pattern-inside: ob_start($CALLABLE, ...)
        - pattern-inside: oci_register_taf_callback($CONNECTION, $CALLABLE)
        - pattern-inside: readline_callback_handler_install($PROMPT, $CALLABLE)
        - pattern-inside: readline_completion_function($CALLABLE)
        - pattern-inside: register_shutdown_function($CALLABLE, ...)
        - pattern-inside: register_tick_function($CALLABLE, ...)
        - pattern-inside: rnp_ffi_set_pass_provider($FFI, $CALLABLE)
        - pattern-inside: sapi_windows_set_ctrl_handler($CALLABLE, ...)
        - pattern-inside: set_error_handler($CALLABLE, ...)
        - pattern-inside: set_exception_handler($CALLABLE)
        - pattern-inside: setAuthorizer($CALLABLE)
        - pattern-inside: spl_autoload_register($CALLABLE, ...)
        - pattern-inside: uasort($ARRAY, $CALLABLE)
        - pattern-inside: uksort($ARRAY, $CALLABLE)
        - pattern-inside: usort($ARRAY, $CALLABLE)
        - pattern-inside: xml_set_character_data_handler($PARSER, $CALLABLE)
        - pattern-inside: xml_set_default_handler($PARSER, $CALLABLE)
        - pattern-inside: xml_set_element_handler($PARSER, $CALLABLE, $CALLABLE)
        - pattern-inside: xml_set_notation_decl_handler($PARSER, $CALLABLE)
        - pattern-inside: Yar_Concurrent_Client::loop($CALLABLE, ...)
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
        - pattern: file_get_contents('php://input')
    severity: WARNING
- rules:
  - fix: echo htmlentities($...VARS);
    id: echoed-request
    languages:
    - php
    message: '`Echo`ing user input risks cross-site scripting vulnerability. You should
      use `htmlentities()` when showing data to users.'
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-79: Improper Neutralization of Input During Web Page Generation (''Cross-site
        Scripting'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A07:2017 - Cross-Site Scripting (XSS)
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.htmlentities.php
      - https://www.php.net/manual/en/reserved.variables.request.php
      - https://www.php.net/manual/en/reserved.variables.post.php
      - https://www.php.net/manual/en/reserved.variables.get.php
      - https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - pattern: htmlentities(...)
    - pattern: htmlspecialchars(...)
    - pattern: strip_tags(...)
    - pattern: isset(...)
    - pattern: empty(...)
    - pattern: esc_html(...)
    - pattern: esc_attr(...)
    - pattern: wp_kses(...)
    - pattern: e(...)
    - pattern: twig_escape_filter(...)
    - pattern: xss_clean(...)
    - pattern: html_escape(...)
    - pattern: Html::escape(...)
    - pattern: Xss::filter(...)
    - pattern: escapeHtml(...)
    - pattern: escapeHtml(...)
    - pattern: escapeHtmlAttr(...)
    pattern-sinks:
    - pattern: echo $...VARS;
    pattern-sources:
    - pattern: $_REQUEST
    - pattern: $_GET
    - pattern: $_POST
    severity: ERROR
- rules:
  - id: tainted-exec
    languages:
    - php
    message: User input is passed to a function that executes a shell command. This
      can lead to remote code execution.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-78: Improper Neutralization of Special Elements used in an OS Command
        (''OS Command Injection'')'
      impact: HIGH
      likelihood: MEDIUM
      owasp:
      - A03:2021 - Injection
      references:
      - https://owasp.org/Top10/A03_2021-Injection
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - patterns:
      - pattern-either:
        - pattern: escapeshellcmd(...)
        - pattern: escapeshellarg(...)
    pattern-sinks:
    - patterns:
      - pattern-either:
        - pattern: exec(...)
        - pattern: system(...)
        - pattern: passthru(...)
        - patterns:
          - pattern: proc_open(...)
          - pattern-not: proc_open([...], ...)
        - pattern: popen(...)
        - pattern: expect_popen(...)
        - pattern: shell_exec(...)
        - pattern: '`...`

            '
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
        - pattern: file_get_contents('php://input')
    severity: WARNING
- rules:
  - id: tainted-object-instantiation
    languages:
    - php
    message: <- A new object is created where the class name is based on user input.
      This could lead to remote code execution, as it allows to instantiate any class
      in the application.
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-470: Use of Externally-Controlled Input to Select Classes or Code (''Unsafe
        Reflection'')'
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A03:2021 - Injection
      references:
      - https://owasp.org/Top10/A03_2021-Injection
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sinks:
    - patterns:
      - pattern-either:
        - pattern-inside: new $SINK(...)
      - pattern: $SINK
    pattern-sources:
    - patterns:
      - pattern-either:
        - pattern: $_GET
        - pattern: $_POST
        - pattern: $_COOKIE
        - pattern: $_REQUEST
        - pattern: $_SERVER
    severity: WARNING
- rules:
  - fix: print(htmlentities($...VARS));
    id: printed-request
    languages:
    - php
    message: '`Printing user input risks cross-site scripting vulnerability. You should
      use `htmlentities()` when showing data to users.'
    metadata:
      category: security
      confidence: MEDIUM
      cwe:
      - 'CWE-79: Improper Neutralization of Input During Web Page Generation (''Cross-site
        Scripting'')'
      cwe2021-top25: true
      cwe2022-top25: true
      impact: MEDIUM
      likelihood: MEDIUM
      owasp:
      - A07:2017 - Cross-Site Scripting (XSS)
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.htmlentities.php
      - https://www.php.net/manual/en/reserved.variables.request.php
      - https://www.php.net/manual/en/reserved.variables.post.php
      - https://www.php.net/manual/en/reserved.variables.get.php
      - https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
      subcategory:
      - vuln
      technology:
      - php
    mode: taint
    pattern-sanitizers:
    - pattern: htmlentities(...)
    - pattern: htmlspecialchars(...)
    - pattern: strip_tags(...)
    - pattern: isset(...)
    - pattern: empty(...)
    - pattern: esc_html(...)
    - pattern: esc_attr(...)
    - pattern: wp_kses(...)
    - pattern: e(...)
    - pattern: twig_escape_filter(...)
    - pattern: xss_clean(...)
    - pattern: html_escape(...)
    - pattern: Html::escape(...)
    - pattern: Xss::filter(...)
    - pattern: escapeHtml(...)
    - pattern: escapeHtml(...)
    - pattern: escapeHtmlAttr(...)
    pattern-sinks:
    - pattern: print($...VARS);
    pattern-sources:
    - pattern: $_REQUEST
    - pattern: $_GET
    - pattern: $_POST
    severity: ERROR
- rules:
  - id: sha224-hash
    languages:
    - php
    message: This code uses a 224-bit hash function, which is deprecated or disallowed
      in some security policies. Consider updating to a stronger hash function such
      as SHA-384 or higher to ensure compliance and security.
    metadata:
      category: security
      confidence: HIGH
      cwe:
      - 'CWE-328: Use of Weak Hash'
      impact: LOW
      likelihood: LOW
      owasp:
      - A03:2017 - Sensitive Data Exposure
      - A02:2021 - Cryptographic Failures
      references:
      - https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar3.ipd.pdf
      - https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/ism/cyber-security-guidelines/guidelines-cryptography
      subcategory:
      - audit
      technology:
      - php
    pattern-either:
    - pattern: hash('sha224', ...);
    - pattern: hash('sha512/224', ...);
    - pattern: hash('sha3-224', ...);
    - pattern: hash_hmac('sha224', ...);
    - pattern: hash_hmac('sha512/224', ...);
    - pattern: hash_hmac('sha3-224', ...);
    severity: WARNING
- rules:
  - id: assert-use-audit
    languages:
    - php
    message: Calling assert with user input is equivalent to eval'ing.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code
        (''Eval Injection'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://www.php.net/manual/en/function.assert
      - https://github.com/FloeDesignTechnologies/phpcs-security-audit/blob/master/Security/Sniffs/BadFunctions/AssertsSniff.php
      subcategory:
      - audit
      technology:
      - php
    patterns:
    - pattern: assert($ASSERT, ...);
    - pattern-not: assert("...", ...);
    - metavariable-regex:
        metavariable: $ASSERT
        regex: \A\$[A-Za-z\[\]\-_'"\$]+(\-\>\w+)?\Z
    severity: ERROR
- rules:
  - id: openssl-decrypt-validate
    languages:
    - php
    message: The function `openssl_decrypt` returns either a string of the decrypted
      data on success or `false` on failure. If the failure case is not handled, this
      could lead to undefined behavior in your application. Please handle the case
      where `openssl_decrypt` returns `false`.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-252: Unchecked Return Value'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A02:2021 - Cryptographic Failures
      references:
      - https://www.php.net/manual/en/function.openssl-decrypt.php
      subcategory:
      - audit
      technology:
      - php
      - openssl
    patterns:
    - pattern: openssl_decrypt(...);
    - pattern-not-inside: "$DECRYPTED_STRING = openssl_decrypt(...);\n...\nif($DECRYPTED_STRING\
        \ === false){\n  ...\n}\n"
    - pattern-not-inside: "$DECRYPTED_STRING = openssl_decrypt(...);\n...\nif($DECRYPTED_STRING\
        \ == false){\n  ...\n}\n"
    - pattern-not-inside: "$DECRYPTED_STRING = openssl_decrypt(...);\n...\nif(false\
        \ === $DECRYPTED_STRING){\n  ...\n}\n"
    - pattern-not-inside: "$DECRYPTED_STRING = openssl_decrypt(...);\n...\nif(false\
        \ == $DECRYPTED_STRING){\n  ...\n}\n"
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        assertTrue(false !== $DECRYPTED_STRING,...);

        '
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        assertTrue($DECRYPTED_STRING !== false,...);

        '
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        $REFERENCE::assertTrue(false !== $DECRYPTED_STRING,...);

        '
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        $REFERENCE::assertTrue($DECRYPTED_STRING !== false,...);

        '
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        assert(false !== $DECRYPTED_STRING,...);

        '
    - pattern-not-inside: '$DECRYPTED_STRING = openssl_decrypt(...);

        ...

        assert($DECRYPTED_STRING !== false,...);

        '
    severity: WARNING
- rules:
  - id: wp-sql-injection-audit
    languages:
    - php
    message: Detected unsafe API methods. This could lead to SQL Injection if the
      used variable in the functions are user controlled and not properly escaped
      or sanitized. In order to prevent SQL Injection, use safe api methods like "$wpdb->prepare"
      properly or escape/sanitize the data properly.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command
        (''SQL Injection'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#sql-injection
      - https://owasp.org/www-community/attacks/SQL_Injection
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: $wpdb->query(...)
      - pattern: $wpdb->get_var(...)
      - pattern: $wpdb->get_row(...)
      - pattern: $wpdb->get_col(...)
      - pattern: $wpdb->get_results(...)
      - pattern: $wpdb->replace(...)
    - pattern-not: $wpdb->prepare(...)
    - pattern-not: $wpdb->delete(...)
    - pattern-not: $wpdb->update(...)
    - pattern-not: $wpdb->insert(...)
    severity: WARNING
- rules:
  - id: wp-code-execution-audit
    languages:
    - php
    message: These functions can lead to code injection if the data inside them is
      user-controlled. Don't use the input directly or validate the data properly
      before passing it to these functions.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-94: Improper Control of Generation of Code (''Code Injection'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#php-code-execution
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: eval(...)
      - pattern: assert(...)
      - pattern: call_user_func(...)
    severity: WARNING
- rules:
  - id: wp-csrf-audit
    languages:
    - php
    message: Passing false or 0 as the third argument to this function will not cause
      the script to die, making the check useless.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-352: Cross-Site Request Forgery (CSRF)'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A05:2021 - Security Misconfiguration
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#cross-site-request-forgery-csrf
      - https://developer.wordpress.org/reference/functions/check_ajax_referer/
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    pattern: check_ajax_referer(...,...,false)
    severity: WARNING
- rules:
  - id: wp-file-download-audit
    languages:
    - php
    message: These functions can be used to read to content of the files if the data
      inside is user-controlled. Don't use the input directly or validate the data
      properly before passing it to these functions.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-73: External Control of File Name or Path'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A01:2021 - Broken Access Control
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#file-download
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: file(...)
      - pattern: readfile(...)
      - pattern: file_get_contents(...)
    severity: WARNING
- rules:
  - id: wp-file-inclusion-audit
    languages:
    - php
    message: These functions can lead to Local File Inclusion (LFI) or Remote File
      Inclusion (RFI) if the data inside is user-controlled. Validate the data properly
      before passing it to these functions.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-22: Improper Limitation of a Pathname to a Restricted Directory (''Path
        Traversal'')'
      - 'CWE-73: The software allows user input to control or influence paths of file
        names that are used in filesystem operations.'
      - 'CWE-98: Improper Control of Filename for Include/Require Statement in PHP
        Program (''PHP Remote File Inclusion'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A01:2021 - Broken Access Control
      - A08:2021 - Software and Data Integrity Failures
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#file-inclusion
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: include(...)
      - pattern: require(...)
      - pattern: include_once(...)
      - pattern: require_once(...)
      - pattern: fread(...)
    severity: WARNING
- rules:
  - id: wp-command-execution-audit
    languages:
    - php
    message: These functions can lead to command execution if the data inside them
      is user-controlled. Don't use the input directly or validate the data properly
      before passing it to these functions.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-78: Improper Neutralization of Special Elements used in an OS Command
        (''OS Command Injection'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#command-execution
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: system(...)
      - pattern: exec(...)
      - pattern: passthru(...)
      - pattern: shell_exec(...)
    severity: WARNING
- rules:
  - id: wp-ajax-no-auth-and-auth-hooks-audit
    languages:
    - php
    message: These hooks allow the developer to handle the custom AJAX endpoints."wp_ajax_$action"
      hook get fires for any authenticated user and "wp_ajax_nopriv_$action" hook
      get fires for non-authenticated users.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-285: Improper Authorization'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A01:2021 - Broken Access Control
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#authorisation
      - https://developer.wordpress.org/reference/hooks/wp_ajax_action/
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern: add_action($HOOK,...)
    - metavariable-regex:
        metavariable: $HOOK
        regex: '''wp_ajax_.*'''
    severity: WARNING
- rules:
  - id: wp-open-redirect-audit
    languages:
    - php
    message: This function can be used to redirect to user supplied URLs. If user
      input is not sanitised or validated, this could lead to Open Redirect vulnerabilities.
      Use "wp_safe_redirect()" to prevent this kind of attack.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-601: URL Redirection to Untrusted Site (''Open Redirect'')'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A05:2021 - Security Misconfiguration
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#open-redirect
      - https://developer.wordpress.org/reference/functions/wp_safe_redirect/
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    pattern: wp_redirect(...)
    severity: WARNING
- rules:
  - id: wp-file-manipulation-audit
    languages:
    - php
    message: These functions can be used to delete the files if the data inside the
      functions are user controlled. Use these functions carefully.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-22: Improper Limitation of a Pathname to a Restricted Directory (''Path
        Traversal'')'
      - 'CWE-73: The software allows user input to control or influence paths of file
        names that are used in filesystem operations.'
      - 'CWE-98: Improper Control of Filename for Include/Require Statement in PHP
        Program (''PHP Remote File Inclusion'')'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A01:2021 - Broken Access Control
      - A08:2021 - Software and Data Integrity Failures
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#file-manipulation
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: unlink(...)
      - pattern: wp_delete_file(...)
    severity: WARNING
- rules:
  - id: wp-authorisation-checks-audit
    languages:
    - php
    message: These are some of the patterns used for authorisation. Look properly
      if the authorisation is proper or not.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-285: Improper Authorization'
      impact: MEDIUM
      likelihood: LOW
      owasp:
      - A01:2021 - Broken Access Control
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#authorisation
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern: $FUNCTION(...)
    - metavariable-regex:
        metavariable: $FUNCTION
        regex: current_user_can|is_admin|is_user_logged_in|is_user_admin
    severity: WARNING
- rules:
  - id: wp-php-object-injection-audit
    languages:
    - php
    message: If the data used inside the patterns are directly used without proper
      sanitization, then this could lead to PHP Object Injection. Do not use these
      function with user-supplied input, use JSON functions instead.
    metadata:
      category: security
      confidence: LOW
      cwe:
      - 'CWE-502: Deserialization of Untrusted Data'
      impact: HIGH
      likelihood: LOW
      owasp:
      - A03:2021 - Injection
      references:
      - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#php-object-injection
      - https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection
      subcategory:
      - audit
      technology:
      - Wordpress Plugins
    paths:
      include:
      - wp-content/plugins/**/*.php
    patterns:
    - pattern-either:
      - pattern: unserialize(...)
      - pattern: maybe_unserialize(...)
    severity: WARNING
